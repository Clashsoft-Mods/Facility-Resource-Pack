version = 'git describe --tags'.execute().text[1..-2] // strip v and \n

tasks.register('copy', Sync) {
  it.from 'src/'
  it.into "$buildDir/src/"

  it.include '**/*.png', '**/*.mcmeta', '**/*.txt', '**/*.lang', '**/*.json'

  it.exclude '**/dev_*/**'

  it.filesMatching('pack.mcmeta') {
    filter {
      return it.replace('$$version$$', project.version)
    }
  }
}

tasks.register('build', Zip) {
  it.dependsOn 'copy'

  it.from "$buildDir/src/"
  it.destinationDir = file("$buildDir/libs")
  it.archiveName = "resources-${ project.version }.zip"
}
